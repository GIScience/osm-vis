'use strict';var width=.9*window.innerWidth;var height=.96*window.innerHeight-180;var timestampMin='2007-08-01T00:00:00Z';$(document).ready(function(){var featureZeroTime={properties:{timestamp:0}};var featureToTime=function featureToTime(f){return moment(f.properties.timestamp);};var map=L.map('map',{zoomControl:false,zoomSnap:0,scrollWheelZoom:false,touchZoom:false,boxZoom:false,doubleClickZoom:false,dragging:false});new L.StamenTileLayer('toner').setOpacity(.14).addTo(map);mapPreventDrag('timeslider');var svgLayers=[];var json2=null;var redrawFunction=function redrawFunction(json){return function(m){if(json===null)return;var json2b=R.compose(R.reduce(R.maxBy(function(f){return featureToTime(f).unix();}),featureZeroTime),R.filter(function(f){return moment(f.properties.timestamp).isSameOrBefore(m);}))(topojson.getObject(json).geometries);if(json2==json2b)return;json2=json2b;var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=svgLayers[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var l=_step.value;l.removeFrom(map);}}catch(err){_didIteratorError=true;_iteratorError=err;}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return();}}finally{if(_didIteratorError){throw _iteratorError;}}}var geoJson=topojson.feature(json,json2);if(geoJson.geometry===null)return;svgLayers=[L.geoJSON(geoJson,{color:colorPrimaryDark,fillColor:colorPrimaryDark,fillOpacity:.4}).addTo(map)];var drawNodes=function drawNodes(cs){if(cs instanceof Array){if(cs[0]instanceof Array)R.forEach(drawNodes,cs);else svgLayers.push(L.circleMarker(R.reverse(cs),{color:colorPrimaryDark,fillColor:'white',fillOpacity:1,radius:2,weight:2}).addTo(map));}};drawNodes(geoJson.geometry.coordinates);};};var slider=new SliderTime({min:moment(timestampMin),max:moment(),width:width,playingHide:false,playingSpeed:10000,playingRestartOnEnd:false});new OptionsPanel({elements:[{type:'radio',name:'data',values:[['r60105',{label:'Mannheim Palace (Germany)',selected:true}],['w254154168','Heidelberg Castle (Germany)'],['w150834648','Luisenpark, Mannheim (Germany)'],['w26946230','New Campus ‘Neuenheimer Feld’, Heidelberg (Germany)'],['w5182648','Heidelberg Zoo (Germany)'],['w154937898','residential area in Heidelberg (Germany)']]}],onStoreUpdate:function onStoreUpdate(store){return $.getJSON('../data/tmp/'+store.data+'.topojson',function(json){map.fitBounds(topojson.getBounds(json),{padding:[(window.innerWidth-width)/2,(window.innerHeight-height)/2]});slider.setCallback(redrawFunction(json));var getTime=function getTime(f,tToCompare){return R.compose(R.reduce(f(function(t){return t.unix();}),tToCompare),R.map(featureToTime))(topojson.getObject(json).geometries);};slider.stopPlaying();slider.setFrom(getTime(R.minBy,moment()));});}});initPage({infoDescription:'OSM elements are modified to reflect changes of the environment, or to improve the quality of the data. These modifications are interesting to examine for single OSM elements because they illustrate how the OSM data is changing. This visualization shows how the boundary defining an OSM element is changing in its history.',infoIdea:[franzBenjaminMocnik],infoProgramming:[franzBenjaminMocnik,martinRaifer],infoData:[heigitDB()],infoLibraries:libsDefault.concat([libIonRangeSlider,libMomentRound,libTopoJSON]),init:function init(){initTooltip({selector:'input[name="data"]:first',text:'Choose different elements to examine.',positionMy:'bottom left',positionAt:'top center'});initTooltip({selector:'.irs-slider',text:'Drag to change the point in time',positionMy:'bottom left',positionAt:'top center'});initTooltip({selector:'.timesliderPlaying',text:'Click here to animate time',positionMy:'bottom right',positionAt:'top right'});}});});